version: '3.8'

services:
  wp-vulnerability-scanner:
    build: .
    image: wp-vulnerability-scanner
    container_name: wp-vulnerability-scanner
    
    # Run in interactive mode for scanning
    stdin_open: true
    tty: true
    
    # Volume mounts
    volumes:
      # Mount Docker socket for local scanning
      - /var/run/docker.sock:/var/run/docker.sock
      # Mount SSH keys for remote scanning
      - /root/.ssh:/root/.ssh:ro
      # Mount SSH agent socket for agent-based authentication
      - ${SSH_AUTH_SOCK:-/dev/null}:/ssh-agent
    
    # Environment variables
    environment:
      - SSH_AUTH_SOCK=/ssh-agent
    
    # Default command: Runs in dry-run mode for safety
    # You can override with specific flags:
    # - For local scanning:   --local --quarantine
    # - For remote scanning:  --host <hostname> --user <username> --quarantine
    # - Skip health checks:   --skip-health-check
    command: ["--help"]
    
    # Environment variables (optional, for convenience)
    # environment:
      # Uncomment and set if needed:
      # SSH_KEY_PATH: /root/.ssh/id_rsa
      # REMOTE_HOST: example.com
      # REMOTE_USER: root
